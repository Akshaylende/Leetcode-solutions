## 184. Department Highest Salary ##


# Problem Link - 
https://leetcode.com/problems/department-highest-salary/description/

# Problem Statement -
Write a solution to find employees who have the highest salary in each of the departments.

Return the result table in any order.

# Query - 
select  
    d.name as Department,
    e.name as Employee,
    e.salary as Salary
from 
    Employee e
join 
    Department d
on 
    e.departmentId = d.id
where 
    salary = (select max(salary) from Employee where departmentId = e.departmentId);


# Approach 2 

with cte as(
    select 
        *,
        Dense_rank() over (
            partition by e.departmentId
            order by e.salary desc
        ) as ranks
    from 
        Employee e
)

select 
    d.name as Department,
    c.name as Employee,
    c.salary as salary 
from  
    cte c
join 
    Department d
on 
    c.departmentId = d.id
where 
    c.ranks = 1;